[How does blockchain really work? I built an app to show you.](https://medium.freecodecamp.org/how-does-blockchain-really-work-i-built-an-app-to-show-you-6b70cd4caf7d)

# åŒºå—é“¾æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿåšä¸€ä¸ªåº”ç”¨å¸¦ä½ äº†è§£

![](https://cdn-images-1.medium.com/max/2000/1*1v2Ou1SwgtvFbC6A2wa9xQ.gif)

According to Wikipedia, a blockchain is:

Wikipedia ä¸Šå¯¹åŒºå—é“¾çš„æè¿°ï¼š

A distributed database that is used to maintain a continuously growing list of records, called blocks.

>ç»´æŠ¤ä¸æ–­å¢é•¿çš„è®°å½•ï¼ˆç§°ä½œåŒºå—ï¼‰çš„åˆ†å¸ƒå¼æ•°æ®åº“ã€‚

That sounds nice, but how does it work?

å¬ä¸Šå»å¾ˆç®€å•ï¼Œä½†åˆ°åº•æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ

To illustrate a blockchain, we will use an open source command-line interface called Blockchain CLI.

æˆ‘ä»¬ç”¨ä¸€æ¬¾å¼€æºå‘½ä»¤è¡Œç•Œé¢ [Blockchain CLI](https://github.com/seanseany/blockchain-cli) æ¥è¯¦ç»†è¯´æ˜åŒºå—é“¾ã€‚

I also built a browser-based version of this here.

æˆ‘ä¹Ÿæ„å»ºäº†ä¸€ä¸ª[æµè§ˆå™¨å¯ä»¥è®¿é—®çš„åœ¨çº¿ç‰ˆ](http://blockchaindemo.io/)

![](https://cdn-images-1.medium.com/max/800/1*cdVD7nxyDPb35phEisVXww.png)

## Installing the Command-Line Interface version
## å®‰è£…å‘½ä»¤è¡Œç•Œé¢

If you havenâ€™t already, install Node.js.

é¦–å…ˆè¯·ç¡®ä¿å®‰è£… [Node.js](https://nodejs.org/download/)

Then run the following in your terminal:

ç„¶ååœ¨ç»ˆç«¯é‡Œè¿è¡Œä¸‹é¢å‘½ä»¤ï¼š

``` js
npm install blockchain-cli -g
blockchain
```

You should see ğŸ‘‹ Welcome to Blockchain CLI!and a blockchain â†’ prompt ready to take commands.

ä½ å°†çœ‹åˆ° `ğŸ‘‹ Welcome to Blockchain CLI!` å’Œ `blockchain â†’` æç¤ºå·²å‡†å¤‡å¥½æ¥å—å‘½ä»¤ã€‚

## What does a block look like?
## åŒºå—æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Ÿ

To see your current blockchain, enter blockchain or bc into the command prompt. You should see a block like the image below.

ä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ `blockchain` æˆ– `bc` æ¥æŸ¥çœ‹ä½ å½“å‰çš„åŒºå—é“¾ã€‚ä½ å°†çœ‹åˆ°ä¸‹å›¾ç±»ä¼¼çš„åŒºå—ã€‚

![](https://cdn-images-1.medium.com/max/800/1*Y3c_hIqCuiDH4x-8dObVyg.png)

* Index (Block #): Which block is it? (Genesis block has index 0)
* Hash: Is the block valid?
* Previous Hash: Is the previous block valid?
* Timestamp: When was the block added?
* Data: What information is stored on the block?
* Nonce: How many iterations did we go through before we found a valid block?

* ç´¢å¼•ï¼ˆåŒºå—ï¼‰ï¼šè¿™æ˜¯å“ªä¸ªåŒºå—ï¼Ÿï¼ˆåˆå§‹åŒºå—ç´¢å¼•ä¸º 0ï¼‰
* å“ˆå¸Œï¼šåŒºå—æœ‰æ•ˆå—ï¼Ÿ
* å‰ä¸ªå“ˆå¸Œï¼šä¹‹å‰ä¸€ä¸ªåŒºå—æœ‰æ•ˆå—ï¼Ÿ
* æ—¶é—´æˆ³ï¼šåŒºå—ä»€ä¹ˆæ—¶å€™æ·»åŠ çš„ï¼Ÿ
* æ•°æ®ï¼šåŒºå—ä¸­å­˜çš„ä»€ä¹ˆä¿¡æ¯ï¼Ÿ
* éšæœºæ•°ï¼ˆNonceï¼‰ï¼šæˆ‘ä»¬é‡å¤äº†å¤šå°‘æ¬¡æ‰æ‰¾åˆ°æœ‰æ•ˆçš„åŒºå—ï¼Ÿ


### Genesis Block
### åˆå§‹åŒºå—

Every blockchain will start with theğŸ† Genesis Block. As you will see later, each block on the blockchain is dependent on the previous block. So, the Genesis block is needed to mine our first block.

æ¯ä¸ªåŒºå—é“¾éƒ½ä¼šä»¥ä¸€ä¸ª `ğŸ† Genesis Block` ä½œä¸ºå¼€å§‹ã€‚ä½ æ¥ä¸‹æ¥å°†ä¼šçœ‹åˆ°æ¯ä¸ªåŒºå—éƒ½å…³è”å‰ä¸€ä¸ªåŒºå—ã€‚æ‰€ä»¥æˆ‘ä»¬å¼€é‡‡ç¬¬ä¸€ä¸ªåŒºå—å‰ï¼Œè¦æœ‰åˆå§‹åŒºå—ã€‚

## What happens when a new block is mined?
## å½“ä¸€ä¸ªæ–°çš„åŒºå—è¢«å¼€é‡‡å‡ºæ¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

![](https://cdn-images-1.medium.com/max/800/1*SmJPc37pUbFySCvUdxnQxA.gif)

Letâ€™s mine our first block. Enter mine freeCodeCampâ™¥ï¸ into the prompt.
The blockchain looks at the latest block on the blockchain for the index and previous hash. In this case Genesis block is the latest block.

è®©æˆ‘ä»¬æ¥å¼€é‡‡æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªåŒºå—ï¼Œåœ¨æç¤ºæ¡†è¾“å…¥ `mine freeCodeCampâ™¥ï¸` å‘½ä»¤ã€‚
åŒºå—é“¾æ ¹æ®æœ€åä¸€ä¸ªåŒºå—ç”Ÿæˆå½“å‰ç´¢å¼•å’Œå‰ä¸ªå“ˆå¸Œã€‚æˆ‘ä»¬ç°åœ¨çš„åŒºå—é“¾æœ€åä¸€ä¸ªåŒºå—å°±æ˜¯åˆå§‹åŒºå—ã€‚

* Index: o+1 = 1
* Previous Hash: 0000018035a828da0â€¦
* Timestamp: When the block is added
* Data: freeCodeCampâ¤
* Hash: ??
* Nonce: ??

* ç´¢å¼•ï¼šo+1 = 1
* å‰ä¸ªå“ˆå¸Œï¼š0000018035a828da0â€¦
* æ—¶é—´æˆ³ï¼šåŒºå—ä»€ä¹ˆæ—¶å€™æ·»åŠ çš„ï¼Ÿ
* æ•°æ®ï¼šfreeCodeCampâ¤
* å“ˆå¸Œï¼š??
* éšæœºæ•°ï¼ˆNonce)ï¼š??

## How is the hash calculated?
## å“ˆå¸Œå€¼å¦‚ä½•è®¡ç®—ï¼Ÿ

A hash value is a numeric value of a fixed length that uniquely identifies data.

å“ˆå¸Œå€¼æ˜¯å›ºå®šé•¿åº¦çš„æ•°å€¼ï¼Œç”¨æ¥æ ‡è¯†å”¯ä¸€æ•°æ®ã€‚

The hash is calculated by taking the index, previous block hash, timestamp, block data, and nonce as input.

å“ˆå¸Œé€šè¿‡å°†ç´¢å¼•ã€å‰ä¸ªå“ˆå¸Œã€æ—¶é—´æˆ³ã€æ•°æ®ã€éšæœºæ•°ä½œä¸ºè¾“å…¥åè®¡ç®—å¾—å‡ºã€‚

```
CryptoJS.SHA256(index + previousHash + timestamp + data + nonce)
```

The SHA256 algorithm will calculate a unique hash, given those inputs. The same inputs will always return the same hash.

SHA256 ç®—æ³•é€šè¿‡ç»™å®šçš„è¾“å…¥ï¼Œè®¡ç®—å‡ºä¸€ä¸ªå”¯ä¸€çš„å“ˆå¸Œã€‚ç›¸åŒçš„è¾“å…¥æ€»ä¼šç”Ÿæˆç›¸åŒçš„å“ˆå¸Œã€‚

### Did you notice the four leading 0â€™s in the block hash?
### ä½ æ³¨æ„åˆ°å“ˆå¸Œå¼€å¤´çš„å››ä¸ª 0 äº†å—ï¼Ÿ

The four leading 0â€™s is a minimum requirement for a valid hash. The number of leading 0â€™s required is called difficulty.

å¼€å¤´çš„å››ä¸ª 0 æ˜¯æœ‰æ•ˆå“ˆå¸Œçš„åŸºæœ¬è¦æ±‚ã€‚å¼€å¤´ 0 çš„ä¸ªæ•°è¢«ç§°ä¸ºéš¾åº¦å€¼ï¼ˆdifficultyï¼‰ã€‚

``` js
function isValidHashDifficulty(hash, difficulty) {
  for (var i = 0, b = hash.length; i < b; i ++) {
      if (hash[i] !== '0') {
          break;
      }
  }
  return i >= difficulty;
}
```

This is also known as the Proof-of-Work system.

è¿™å°±æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„[å·¥ä½œé‡è¯æ˜ç³»ç»Ÿ](https://en.wikipedia.org/wiki/Proof-of-work_system)

## Whatâ€™s a nonce?
## ä»€ä¹ˆæ˜¯éšæœºæ•°ï¼Ÿ

A nonce is a number used to find a valid hash.

éšæœºæ•°æ˜¯ç”¨æ¥å¯»æ‰¾æœ‰æ•ˆå“ˆå¸Œçš„ä¸€ä¸ªæ•°å­—ã€‚

``` js
let nonce = 0;
let hash;
let input;
while(!isValidHashDifficulty(hash)) {     
  nonce = nonce + 1;
  input = index + previousHash + timestamp + data + nonce;
  hash = CryptoJS.SHA256(input)
}
```

The nonce iterates until the hash is valid. In our case, a valid hash has at least four leading 0â€™s. The process of finding a nonce that corresponds to a valid hash is mining.

éšæœºæ•°ä¸æ–­è¿­ä»£ï¼Œç›´åˆ°å“ˆå¸Œæœ‰æ•ˆã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæœ‰æ•ˆçš„å“ˆå¸Œå€¼è‡³å°‘è¦å››ä¸ª 0 å¼€å¤´ã€‚å¯»æ‰¾æœ‰æ•ˆå“ˆå¸Œå¯¹åº”éšæœºæ•°çš„è¿‡ç¨‹å°±ç§°ä¸ºå¼€é‡‡ï¼ˆæŒ–çŸ¿ï¼‰ã€‚

As the difficulty increases, the number of possible valid hashes decreases. With less possible valid hashes, it takes more processing power to find a valid hash.

éšç€éš¾åº¦å€¼çš„æå‡ï¼Œæœ‰æ•ˆå“ˆå¸Œçš„æ•°é‡é€æ­¥å‡å°‘ï¼Œæˆ‘ä»¬éœ€è¦æŠ•å…¥æ›´å¤šèµ„æºæ¥æ‰¾åˆ°ä¸€ä¸ªæœ‰æ•ˆå“ˆå¸Œã€‚

## Why does this matter?
## ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿ

It matters because it keeps the blockchain immutable.

å› ä¸ºå®ƒç¡®ä¿äº†åŒºå—é“¾ä¸å¯å˜ã€‚

If we have the following blockchain A â†’ B â†’ C, and someone wants to change data on Block A. This is what happens:

å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªè¿™æ ·çš„åŒºå—é“¾ A â†’ B â†’ Cï¼Œæœ‰äººæƒ³ä¿®æ”¹åŒºå— A ä¸Šçš„æ•°æ®ã€‚ä¼šå‘ç”Ÿä¸‹é¢æƒ…å†µï¼š

Data changes on Block A.
Block Aâ€™s hash changes because data is used to calculate the hash.
Block A becomes invalid because its hash no longer has four leading 0â€™s.
Block Bâ€™s hash changes because Block Aâ€™s hash was used to calculate Block Bâ€™s hash.
Block B becomes invalid because its hash no longer has four leading 0's.
Block Câ€™s hash changes because Block Bâ€™s hash was used to calculate Block Câ€™s hash.
Block C becomes invalid because its hash no longer has four leading 0's.

1. ä¿®æ”¹åŒºå— A ä¸Šçš„æ•°æ®ã€‚
2. åŒºå— A çš„å“ˆå¸Œå˜åŠ¨ï¼Œå› ä¸ºè®¡ç®—å“ˆå¸Œæ‰€ç”¨çš„æ•°æ®å˜åŒ–äº†ã€‚
3. åŒºå— A æ— æ•ˆï¼Œå› ä¸ºå®ƒçš„å“ˆå¸Œä¸æ˜¯å››ä¸ª 0 å¼€å¤´ã€‚
4. åŒºå— B çš„å“ˆå¸Œå˜åŠ¨ï¼Œå› ä¸ºè®¡ç®—åŒºå— B çš„å“ˆå¸Œæ‰€ç”¨åˆ°çš„åŒºå— A çš„å“ˆå¸Œå€¼å˜åŒ–äº†ã€‚
5. åŒºå— B æ— æ•ˆï¼Œå› ä¸ºå®ƒçš„å“ˆå¸Œä¸æ˜¯å››ä¸ª 0 å¼€å¤´ã€‚
6. åŒºå— C çš„å“ˆå¸Œå˜åŠ¨ï¼Œå› ä¸ºè®¡ç®—åŒºå— C çš„å“ˆå¸Œæ‰€ç”¨åˆ°çš„åŒºå— B çš„å“ˆå¸Œå€¼å˜åŒ–äº†ã€‚
7. åŒºå— C æ— æ•ˆï¼Œå› ä¸ºå®ƒçš„å“ˆå¸Œä¸æ˜¯å››ä¸ª 0 å¼€å¤´ã€‚

The only way to mutate a block would be to mine the block again, and all the blocks after. Since new blocks are always being added, itâ€™s nearly impossible to mutate the blockchain.

ä¿®æ”¹ä¸€ä¸ªåŒºå—çš„å”¯ä¸€æ–¹å¼å°±æ˜¯é‡æ–°å¼€é‡‡è¿™ä¸ªåŒºå—ä»¥åŠå®ƒä¹‹åçš„æ‰€æœ‰åŒºå—ã€‚å› ä¸ºæ–°çš„åŒºå—ä¸æ–­å¢åŠ ï¼ŒåŸºæœ¬ä¸å¯èƒ½ä¿®æ”¹åŒºå—é“¾ã€‚

I hope this tutorial was helpful for you!

æˆ‘å¸Œæœ›è¿™ä»½è¯´æ˜å¯¹ä½ æœ‰å¸®åŠ©ã€‚

If you would like to checkout a web version of the demo, head on over to http://blockchaindemo.io

å¦‚æœä½ æƒ³æ£€å‡ºä¾‹å­çš„åœ¨çº¿ç‰ˆæœ¬ï¼Œç§»æ­¥ [http://blockchaindemo.io](http://blockchaindemo.io)